
<p align="center">

<img src="https://github.com/homebridge/branding/raw/master/logos/homebridge-wordmark-logo-vertical.png" width="150">

</p>


# Summary

This was forked from https://github.com/Claywd/homebridge-enphase-battery/blob/master/src/accessory.ts and updated to support the v4 api as well as the grid charging setting which handles about 90% of the previous logic. 

## Install
`npm install -g homebridge-enphase-battery-grid-control`
## Config

Firstly, you need to go to [this page ](https://developer-v4.enphase.com/docs/quickstart.html)and follow the instructions to setup your own developer account. Be sure to click your own auth url and authorize your app ;) 

```json

```

# Warning
The api only allows the auth code that is generated by visiting the authorize url appended with `&redirect_uri=https://api.enphaseenergy.com/oauth/redirect_uri` to be used once... This application writes the token to a local file so it can be used for recovering from reboots but if you disable this plugin for 30 days then neither the token or the refresh token will be of any use. You will need to wipe the cache and supply a new auth code. 

# Archive

## Homebridge Plugin for Enphase Envoy Batteries

This plugin was developed to scratch a very specific itch that Enphase hasn't covered:
charge the battery from the grid when the power is cheaper (assuming you have net-metering and time-of-use)
so all generated electricity is sent back to the grid at higher rates. 

### Install
Install the plugin like you would any homebridge plugin.
Configure the plugin with your credentials and siteId and desired battery thresholds.

### Add to Home
When the accessory is added to your home, it presents a switch that allows you to toggle between "boosted" and regular.
You can now add automation to your home to control this, for example based on the time of day.
